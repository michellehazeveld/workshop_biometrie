---
title: "Biometrie onderzoek"
authors: "Ype de Vos en Michelle Hazeveld (studentennummer: 488153)"
date: "`r Sys.Date()`"
output:
  html_document:
    css: style.css
    toc: yes
    toc_depth: 3
    toc_float:
      collapsed: yes
      smooth_scroll: yes
---

```{r setup, include=FALSE}
# DON'T TOUCH THIS
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)

```


## Inleiding

GEEF EEN HEEL KORTE INLEINDING VAN JE ONDERZOEK

:::info
Het staat je vrij een ander simpel te meten biometrisch kenmerk te onderzoeken. Voorwaarde is wel dat je twee aspecten meet (bv lichaamslengte en hoofdomtrek) en hun relatie onderzoekt, en ook dat je verschillende groepen onderzoekt (man/vrouw, jong/oud etc.). Ten slotte moeten verschillende studenten het meetwerk afwisselen en ook dat moet vastgelegd worden.
:::



:::attention
GEEF HIER JE ONDERZOEKSVRAAG
Is er bij de mens een sekseverschil in de lengte/breedte-ratio van de hand?
:::


:::attention
GEEF HIER JE HYPOTHESE
Er is bij de mens een sekseverschil in de lengte/breedte-ratio van de hand.
:::


:::attention
GEEF HIER JE NULHYPOTHESE
Er is bij de mens geen sekseverschil in de lengte/breedte-ratio van de hand.
:::


### Ontwerp van het experiment

> GEEF EEN KORT OVERZICHT VAN JE EXPERIMENT

### Ontwerp het protocol

VUL HIER ONDER HET PROTOCOL AAN OF PAS DEZE AAN NAAR JOUW OPZET.

:::protocol
#### Protocol voor meting handlengte en handbreedte

##### Benodigdheden

1. Maatlat, schuifmaat of meetlint.  
2. Spreadsheet om resultaten vast te leggen, met toegang hiertoe op locaties zonder internet-toegang.  
3. Je laborant-ID: een unieke _identifier_ die jou als onderzoeker identificeert. Neem hiervoor de laatste 4 cijfers van je studentnummer.

##### Data verzamelen

Zoek, samen met een ander groepje van je klas, in of rond het schoolgebouw medestudenten. Vraag beleefd of ze willen participeren in een klein wetenschappelijk onderzoekje voor school waarbij de maten van de hand opgenomen zullen worden.  
Is het antwoord nee, dan groet je vriendelijk en zoek je verder.  
Is het antwoord ja, dan vraag je of de proefpersoon de hand horizontaal en gestrekt wil houden met de palm naar beneden. Vervolgens meet je zowel de lengte als de breedte van de hand op, in millimeters. Deze leg je vast in de spreadsheet, samen met je laborant-ID en een identifier (géén naam!) van de proefpersoon. Ten slotte vraag je aan de proefpersoon zijn/haar/hun sexe en legt deze vast. Wil de proefpersoon deze niet geven, of is die nonbinair, dan leg je dit vast als "anders/onbekend". Het "parallel groepje" (dat niet jouw bevindingen mag horen) doet dezelfde meting en slaat deze met dezelfde participant identifier op.  
Bedank de proefpersoon voor deelname.  
Wissel de metingen af tussen de verschillende studenten in jouw groepje.

Ga door totdat van voldoende proefpersonen de gegevens zijn verzameld.
:::


## Uitvoering

:::attention
Je moet de onderzoeksresultaten in deze vorm opslaan:  

<pre>
laborant_ID,subject_ID,handlengte,handbreedte,sexe
3241,G1_03,113,104,m
<meer rijen met data>
</pre>
:::


## Analyse

### Lees je eigen data in

Om data vanuit een tekstbestand in te lezen kan je dit codeblok gebruiken, aannemend dat je data er exact zo uitzien als in bovenstaande voorbeeld:

### Beschrijvende statistiek

LAAT ENKELE BESCHRIJVENDE STATISTISCHE WAARDES ZIEN.
GEEF EEN OF MEERDERE BOXPLOTS EN HISTOGRAMMEN
BESPREEK DEZE DATA EN FIGUREN KORT.
KAN JE IETS ZEGGEN OVER DE DATAVERDELING?

```{r demo-data-inlees, eval=FALSE}
data_file <- "zelf_verzamelde_data_handen.csv"

#data format: laborant_ID,subject_ID,handlengte,handbreedte,sexe
biometric_data <- read.table(file = data_file,
                        header = TRUE,
                        sep = ",")

handlengte <- biometric_data[3]
handbreedte <- biometric_data[2]
lengte_breedte_ratio <- handlengte / handbreedte
#c(lengte_breedte_ratio)
# Gebruikte bronnen voor onderstaande code in deze chunk: 
# https://stackoverflow.com/questions/13079387/how-to-add-data-by-columns-in-csv-f# ile-using-r#:~:text=You%20can't%20append%20columns,file%20is%20stored%20on%2Ddis# k.
# https://how.dev/answers/what-are-the-rownames-and-colnames-functions-in-r 
df_ratio <- data.frame(lengte_breedte_ratio)

c(df_ratio)

tmp <- read.csv("zelf_verzamelde_data_handen.csv")
tmp <- cbind(tmp, df_ratio)
colnames(tmp) <- c("nummer", "handbreedte", "handlengte", "geslacht", "lengte_breedte_ratio")
write.csv(tmp, "zelf_verzamelde_data_handen_v2.csv")
biometric_data <- read.table(file = "zelf_verzamelde_data_handen_v2.csv",
                        header = TRUE,
                        sep = ",")
```

Let op: als je missende data hebt moet je die specificeren door dit argument toe te voegen: `na.strings = "<jouw NA symbool>"`
```{r}
#split over gender into list of dataframes
geslacht_split_data <- split(x = biometric_data,
      f = biometric_data$geslacht)

#apply a function to report means of both measurements
sapply(X = geslacht_split_data,
       FUN = function(x){
           c(gem_handlengte = mean(x$handlengte),
             gem_handbreedte = mean(x$handbreedte),
             gem_lengte_breedte_ratio = mean(x$lengte_breedte_ratio),
             stdev_handlengte = sd(x$handlengte),
             stdev_handbreedte = sd(x$handbreedte),
             stdev_lengte_breedte_ratio = sd(x$lengte_breedte_ratio))
       })
```
```{r boxplot-hand-lengte-over-geslacht-ggplot, fig.asp=.75, out.width='80%', fig.align='center'}
ggplot(data = biometric_data,
       mapping = aes(x = geslacht, y = handlengte, fill = geslacht)) +
    geom_boxplot() +
    geom_point() +
    labs(x = "Geslacht", y = "Handlengte (cm)") + 
    theme_minimal()
```
```{r boxplot-hand-lengte-over-geslacht-ggplot, fig.asp=.75, out.width='80%', fig.align='center'}
ggplot(data = biometric_data,
       mapping = aes(x = geslacht, y = handbreedte, fill = geslacht)) +
    geom_boxplot() +
    geom_point() +
    labs(x = "Geslacht", y = "Handbreedte (cm)") + 
    theme_minimal()
```
```{r boxplot-hand-lengte-over-geslacht-ggplot, fig.asp=.75, out.width='80%', fig.align='center'}
ggplot(data = biometric_data,
       mapping = aes(x = geslacht, y = lengte_breedte_ratio, fill = geslacht)) +
    geom_boxplot() +
    geom_point() +
    labs(x = "Geslacht", y = "Lengte/breedte-ratio (cm)") + 
    theme_minimal()
```
```{r ratio-histogram, fig.asp=0.7, out.width='70%', fig.align='center', results='hold'}
ggplot(data = biometric_data,
       mapping = aes(x = handlengte, fill = geslacht)) +
    geom_histogram(bins = 10, colour = "black") + # histogram layer with 10 bins
    facet_wrap(. ~ geslacht) +                       # split plots over gender
    labs(x = "Handlengte (cm)") +
    theme_minimal()
```
```{r ratio-histogram, fig.asp=0.7, out.width='70%', fig.align='center', results='hold'}
ggplot(data = biometric_data,
       mapping = aes(x = handbreedte, fill = geslacht)) +
    geom_histogram(bins = 10, colour = "black") + # histogram layer with 10 bins
    facet_wrap(. ~ geslacht) +                       # split plots over gender
    labs(x = "Handbreedte (cm)") +
    theme_minimal()
```
```{r ratio-histogram, fig.asp=0.7, out.width='70%', fig.align='center', results='hold'}
ggplot(data = biometric_data,
       mapping = aes(x = lengte_breedte_ratio, fill = geslacht)) +
    geom_histogram(bins = 10, colour = "black") + # histogram layer with 10 bins
    facet_wrap(. ~ geslacht) +                       # split plots over gender
    labs(x = "Lengte/breedte-ratio") +
    theme_minimal()
```

### Welke verdeling?
```{r test-for-normality}
shapiro.test(biometric_data$lengte_breedte_ratio)
```
Bij de lengte_breedte_ratio is de p-waarde (=0.2402) groter dan 0.05, dus is de verdeling van de steekproef niet significant verschillend van de normale verdeling. De t-test kan alleen bij een normaalverdeling gebruikt worden. Dus in dit geval kan de t-test gebruikt worden. Hieronder wordt de onafhankelijke t-test uitgevoerd.
```{r t-test-op-ratio}
female_ratios <- subset(biometric_data, 
                        subset = geslacht == "vrouw", 
                        select = lengte_breedte_ratio, 
                        drop = T) # drop = T forces ro a vector
male_ratios <- subset(biometric_data, 
                        subset = geslacht == "man", 
                        select = lengte_breedte_ratio, 
                        drop = T)
t.test(female_ratios, male_ratios)
```
De p-waarde = 0.4218. Dit is groter dan 0.05, dus de nulhypothese wordt niet verworpen. Dit betekent dat er geen bewijs is gevonden voor een significant verschil in handlengte/handbreedte-ratio's tussen mannen en vrouwen.
Hoe kleiner de steekproefgrootte (_sample size_) hoe lastiger het is de onderliggende verdeling vast te stellen. Speel maar eens met dit blokje code, en verander de steekproefgrootte (`n=`) in de `rnorm()` functie en de `breaks=` in de `hist()` functie. 
Neem voor _n_ bijvoorbeeld achtereenvolgens 10, 100, 1000, 10000, 10000 en voor _breaks_ 5, 10, 50. Wanneer zie je een echte normaalverdeling verschijnen? 
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 5, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 50, fill = "gold", colour = "black") +
    theme_minimal()
```

```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 5, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 50, fill = "gold", colour = "black") +
    theme_minimal()
```

```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 1000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 5, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 1000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 1000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 50, fill = "gold", colour = "black") +
    theme_minimal()
```


```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 5, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 10000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 50, fill = "gold", colour = "black") +
    theme_minimal()
```

```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 5, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 10, fill = "gold", colour = "black") +
    theme_minimal()
```
```{r sampling-demo, fig.asp=.6, out.width='60%', fig.align='center'}
hist_data <- data.frame(x = rnorm(n = 100000))
ggplot(data = hist_data,
       mapping = aes(x = x)) +
    geom_histogram(bins = 50, fill = "gold", colour = "black") +
    theme_minimal()
```
:::attention
**Dit _experiment_ met de argumenten van `rnorm()` en `hist()` moet je opnemen in je eigen RMarkdown.**  
Beantwoord deze vragen:



1. Wat gebeurt er met de vorm van de verdeling als `n` groter wordt?
2. Wat gebeurt er met de spreiding van de data (x-as) als `n` groter wordt, en kan je dat verklaren?
3. Waarom is bij zelfde instellingen voor `n` en `breaks` de uitkomst toch verschillend?
4. Welke minimale `n` geeft het meeste kans om een echte normaalverdeling te zien?
5. Wat voor bijzonders is er aan de hand met het `breaks` argument? Geeft de documentatie daar een verklaring voor?

Antwoorden:

1. Als n steeds groter wordt, nadert de vorm van de verdeling steeds meer tot een normaalverdeling.
2. Als n steeds groter wordt, wordt de spreiding steeds kleiner, want de spreiding wordt berekend door sigma / wortel(n) Bron: https://stats.libretexts.org/Bookshelves/Applied_Statistics/Business_Statistics_(OpenStax)/07%3A_The_Central_Limit_Theorem/7.02%3A_Using_the_Central_Limit_Theorem
3. Dit komt denk ik door toevallige fouten.
4. Als ik het antwoord uit de histogrammen haal, denk ik dat n minimaal 10000 moet zijn, maar bij het vak statistiek op mijn vorige school heb ik geleerd dat n minimaal 30 moet zijn.
5. Bij teveel bins zal de variabiliteit groter lijken dan in werkelijkheid. Variabiliteit beschrijft hoe ver de datapunten van elkaar van het centrum van de spreiding liggen. Bij te weinig bins zal de variabiliteit juist kleiner lijken dan in werkelijkheid. Bronnen: 

https://r-charts.com/distribution/histogram-breaks/

https://www.scribbr.com/statistics/variability/#:~:text=Variability%20describes%20how%20far%20apart,as%20spread%2C%20scatter%20or%20dispersion. 
:::

### Bronnen van variatie

ONDERZOEK BRONNEN VAN VARIATIE
BESPREEK DIT KORT

### De hypothese aannemen?

VOER RELEVANTE STATISTISCHE TESTS UIT


## Reflectie op het experiment

:::info
Bespreek in je groep de volgende vragen en voeg de antwoorden toe aan je uitgewerkte onderzoeksdocument.  

1. Zijn de metingen tussen de verschillende meters ook (significant) verschillend? Zo ja, waardoor zou je de verschillen kunnen verklaren?

2. Onderzoek de verschillen tussen mannen en vrouwen met betrekking tot hand lengte, handbreedte en de ratio.

3. Zou je het protocol aanpassen na deze ervaring, of was hij voldoende duidelijk en reproduceerbaar?
:::


:::attention
#### Wat je moet inleveren
Voor de verwerking en analyse van je eigen data maak je gebruik van het aangeleverde template RMarkdown document. Daarin doorloop je dezelfde onderzoek stappen als hieronder, maar dan met je eigen data. Aan het einde van de dag gaat dat document, in originele en "geknitte" vorm, samen met je databestand, in een git repo die is opgezet volgens voorschift in de cursushandleiding. De link hiernaar toe gaat in je portfolio op eJournal. Let op dat je _alle_ stappen hebt doorlopen voordat je inlevert. Gebruik ook de RStudio spellingscontrole!  
Vergeet niet jullie namen en studentnummers bovenaan de markdown te zetten!
:::
